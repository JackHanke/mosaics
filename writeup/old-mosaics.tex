\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,amsthm,amsfonts,amssymb}
\usepackage{tikz}
\usepackage{subfig}
\usepackage[english]{babel}
\usepackage{capt-of}
\newtheorem{theorem}{Theorem}
\usetikzlibrary{calc}
\usetikzlibrary{shapes}
\usepackage{hyperref}
%might be unnecessary
\usepackage{doi}

%bibliography CMDS

%\usepackage{cite}
%\usepackage[style=alphabetic]{biblatex}
%\bibliographystyle{plain}

%\usepackage[style=alphabetic]{biblatex}

\usepackage[backend=biber,style=alphabetic]{biblatex}
%\usepackage[backend=bibtex,style=alphabetic]{biblatex}
\addbibresource{bibb.bib}

%%% With amsthm package, creates environments for nicely formatted,
%%% labeled, and numbered propositions, etc.
\theoremstyle{plain}
\newtheorem{thm}{Theorem}
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{claim}[thm]{Claim}
\newtheorem{fact}[thm]{Fact}

\theoremstyle{definition}
\newtheorem{eg}[thm]{Example}
\newtheorem{defn}[thm]{Definition}
\newtheorem{rem}[thm]{Remark}
\newtheorem{observ}[thm]{Observation}
\newtheorem{open}[thm]{Open Problem}
\newtheorem{prob.}[thm]{Problem}
\newtheorem{quest}[thm]{Question}

% I used these for making definitions and theorems, not what is above
\theoremstyle{remark}
\newtheorem{remark}[thm]{Remark}
\newtheorem{note}[thm]{Note}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{exmp}{Example}[section]

%custom commands

% blank cell
\newcommand{\cell}[4]{ \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 );}

% open cell 
\newcommand{\cellopen}[4]{ \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \node[shape=circle,draw=red,fill=red, inner sep=0pt,minimum size=3pt] (A) at ( #1 * 0.5 + #3 * 0.5 , #2 * 0.5 + #4 * 0.5 ){};}

% /
\newcommand{\cellA}[4]{ \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3 * 0.5 + #1 * 0.5 , #2) -- (#3, #4 * 0.5 + #2 * 0.5);}

% \
\newcommand{\cellB}[4]{ \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3 * 0.5 + #1 * 0.5 , #2) -- (#1, #4 * 0.5 + #2 * 0.5);}

% /
\newcommand{\cellC}[4]{ \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3 * 0.5 + #1 * 0.5 , #4) -- (#1, #4 * 0.5 + #2 * 0.5);}

% L
\newcommand{\cellD}[4]{ \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3 * 0.5 + #1 * 0.5 , #4) -- (#3, #4 * 0.5 + #2 * 0.5);}

% |
\newcommand{\cellE}[4]{ \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3 * 0.5 + #1 * 0.5 , #2) -- (#3 * 0.5 + #1 * 0.5 , #4);}

% -
\newcommand{\cellF}[4]{ \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3, #4 * 0.5 + #2 * 0.5) -- (#1, #4 * 0.5 + #2 * 0.5);}

\newcommand{\cellAf}[4]{\filldraw[gray!40] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3 * 0.5 + #1 * 0.5 , #2) -- (#3, #4 * 0.5 + #2 * 0.5);}

% \
\newcommand{\cellBf}[4]{\filldraw[gray!40] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3 * 0.5 + #1 * 0.5 , #2) -- (#1, #4 * 0.5 + #2 * 0.5);}

% /
\newcommand{\cellCf}[4]{\filldraw[gray!40] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3 * 0.5 + #1 * 0.5 , #4) -- (#1, #4 * 0.5 + #2 * 0.5);}

% L
\newcommand{\cellDf}[4]{\filldraw[gray!40] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3 * 0.5 + #1 * 0.5 , #4) -- (#3, #4 * 0.5 + #2 * 0.5);}

% |
\newcommand{\cellEf}[4]{\filldraw[gray!40] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3 * 0.5 + #1 * 0.5 , #2) -- (#3 * 0.5 + #1 * 0.5 , #4);}

% -
\newcommand{\cellFf}[4]{\filldraw[gray!40] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[thick] ( #1 , #2 ) rectangle ( #3 , #4 ); \draw[red, thick] (#3, #4 * 0.5 + #2 * 0.5) -- (#1, #4 * 0.5 + #2 * 0.5);}

\usepackage[margin=1in]{geometry}


%doc info
\title{Mosaics}
\author{Jack Hanke}
\date{\today}

\begin{document}

\begin{center}
    \Large
    \textbf{Mosaics}
    
    \vspace{0.4cm}
    \large
    
    Jack Hanke   
    \vspace{0.4cm}
    
    \today
    \vspace{0.4cm}    
\end{center}

\section{Introduction}

Consider the following $6$ unit squares with markings on them.

%figure of tiles (colored marknigs!)
\begin{center}
    \begin{tikzpicture}
    \cellA{0}{0}{1}{1}
    \cellB{2}{0}{3}{1}
    \cellC{4}{0}{5}{1}
    \cellD{6}{0}{7}{1}
    \cellE{8}{0}{9}{1}
    \cellF{10}{0}{11}{1}    
    \end{tikzpicture}
\end{center}

Call these squares \textit{tiles}. 

\begin{definition}
An $(n,m)$-\textit{mosaic} is a rectangular grid made up of tiles.
\end{definition}

\begin{exmp}
An example of a $(7,5)$-mosaic:
\begin{center}
\begin{tikzpicture}
% row1
\cellA{0}{0}{1}{1}
\cellB{1}{0}{2}{1}
\cellF{2}{0}{3}{1}
\cellA{3}{0}{4}{1}
\cellC{4}{0}{5}{1}
\cellE{5}{0}{6}{1}
\cellD{6}{0}{7}{1}
% row2
\cellA{0}{1}{1}{2}
\cellE{1}{1}{2}{2}
\cellF{2}{1}{3}{2}
\cellE{3}{1}{4}{2}
\cellE{4}{1}{5}{2}
\cellB{5}{1}{6}{2}
\cellD{6}{1}{7}{2}
% row3
\cellA{0}{2}{1}{3}
\cellB{1}{2}{2}{3}
\cellA{2}{2}{3}{3}
\cellB{3}{2}{4}{3}
\cellA{4}{2}{5}{3}
\cellD{5}{2}{6}{3}
\cellF{6}{2}{7}{3}
% row4
\cellF{0}{3}{1}{4}
\cellE{1}{3}{2}{4}
\cellA{2}{3}{3}{4}
\cellA{3}{3}{4}{4}
\cellE{4}{3}{5}{4}
\cellD{5}{3}{6}{4}
\cellC{6}{3}{7}{4}
% row5
\cellA{0}{4}{1}{5}
\cellD{1}{4}{2}{5}
\cellE{2}{4}{3}{5}
\cellD{3}{4}{4}{5}
\cellD{4}{4}{5}{5}
\cellC{5}{4}{6}{5}
\cellE{6}{4}{7}{5}
\end{tikzpicture}
\end{center}
\end{exmp}

Clearly there are $6^{nm}$ possible mosaics. Which of these mosaics contain self-avoiding polygons?

%example of a mosaic with an enclosed region
\begin{exmp}
An example of a $(7,5)$-mosaic with a self-avoiding polygon:
\begin{center}
\begin{tikzpicture}
% row1
\cellA{0}{0}{1}{1}
\cellB{1}{0}{2}{1}
\cellDf{2}{0}{3}{1}
\cellCf{3}{0}{4}{1}
\cellC{4}{0}{5}{1}
\cellE{5}{0}{6}{1}
\cellD{6}{0}{7}{1}
% row2
\cellA{0}{1}{1}{2}
\cellE{1}{1}{2}{2}
\cellEf{2}{1}{3}{2}
\cellEf{3}{1}{4}{2}
\cellE{4}{1}{5}{2}
\cellB{5}{1}{6}{2}
\cellD{6}{1}{7}{2}
% row3
\cellA{0}{2}{1}{3}
\cellB{1}{2}{2}{3}
\cellAf{2}{2}{3}{3}
\cellBf{3}{2}{4}{3}
\cellA{4}{2}{5}{3}
\cellD{5}{2}{6}{3}
\cellF{6}{2}{7}{3}
% row4
\cellF{0}{3}{1}{4}
\cellE{1}{3}{2}{4}
\cellA{2}{3}{3}{4}
\cellA{3}{3}{4}{4}
\cellE{4}{3}{5}{4}
\cellD{5}{3}{6}{4}
\cellC{6}{3}{7}{4}
% row5
\cellA{0}{4}{1}{5}
\cellD{1}{4}{2}{5}
\cellE{2}{4}{3}{5}
\cellD{3}{4}{4}{5}
\cellD{4}{4}{5}{5}
\cellC{5}{4}{6}{5}
\cellE{6}{4}{7}{5}
\end{tikzpicture}
\end{center}
\end{exmp}

Let $t_{n,m}$ be the number of mosaics that have at least one self avoiding polygon (SAP). From the fact that the smallest SAP is

\begin{center}
\begin{tikzpicture}

% row1
\cellD{0}{0}{1}{1}
\cellC{1}{0}{2}{1}
% row2
\cellA{0}{1}{1}{2}
\cellB{1}{1}{2}{2}
\end{tikzpicture}
\end{center}

we have that $t_{n,1}=t_{1,m}=0$, and $t_{2,2} = 1$. What else can be said?

\begin{theorem}\label{thm: m=2 case}
Setting $m=2$ gives
\begin{equation}
    T_2(x) = \sum_{n \geq 2}t_{n,2}x^n = \frac{x^2}{(1-36x)(1-37x+37x^2)}.
\end{equation}
This can be solved for $n \geq 2$ to give
\begin{equation}
     t_{n,2}= 6^{2n} - \frac{1}{\beta-\alpha}((36\beta-35)\beta^{-n+1} - (36\alpha - 35)\alpha^{-n+1})
\end{equation}

where $\alpha = \frac{1}{2} + \frac{1}{2}\sqrt{\frac{33}{37}}$ and $\beta = \frac{1}{2} - \frac{1}{2}\sqrt{\frac{33}{37}}$.
\end{theorem}

\begin{proof}
We prove that $t_{n,2}$ has
$$t_{n,2} = 36t_{n-1,2} + \sum_{i=2}^{n}(6^{2(n-i)}-t_{n-i,2}).$$

Split $t_{n,2}$ into $S_n$ and $S_n^c$. $S_n$ contains the mosaics that have just $1$ SAP that contains the left-most two cells. This means $S_n^c$ contains all mosaics that contain multiple SAPs and mosaics that contain only $1$ SAP, but that does not contain the two left-most cells.

The subset $S_n$ can be split further by the length of each SAP $i$. 

\begin{center}
\begin{tikzpicture}\label{fig: S breakdown}
\draw[thick] ( 0 , 0 ) rectangle ( 8 , 2 );
% row1
\cellD{0}{0}{1}{1}
\cellC{1}{0}{2}{1}
% row2
\cellA{0}{1}{1}{2}
\cellB{1}{1}{2}{2}

\draw[thick] ( 0 , -2.5 ) rectangle ( 8 , -0.5 );
% row1
\cellD{0}{-2.5}{1}{-1.5}
\cellF{1}{-2.5}{2}{-1.5}
\cellC{2}{-2.5}{3}{-1.5}
% row2
\cellA{0}{-1.5}{1}{-0.5}
\cellF{1}{-1.5}{2}{-0.5}
\cellB{2}{-1.5}{3}{-0.5}

\end{tikzpicture}
\captionof{figure}{Members of $S_n$ of lengths $i=2$ and $i=3$}
\end{center}

As $S_n$ counts the number of mosaics that only contain $1$ SAP, the blank space in Figure \ref{fig: S breakdown} must have no SAPs. The number of mosaics that have no SAPs is $6^{2(n-i)}-t_{n-i,2}$. As a SAP's width can range from $2$ to $n$, we have $|S_n| = \sum_{i=2}^{n}(6^{2(n-i)}-t_{n-i,2}).$

Now consider $S_n^c$. The mosaics that belong to this set can be represented by the following diagram,

\begin{center}
\begin{tikzpicture}
\draw[thick] ( 0 , 0 ) rectangle ( 8 , 2 );
% row1
\cellopen{0}{0}{1}{1}
% row2
\cellopen{0}{1}{1}{2}
% text
\node[shape=circle,draw=white,fill=white, inner sep=0pt,minimum size=0pt] (A) at ( 4 , 1 ){$t_{n-1,2}$};
\end{tikzpicture}
\captionof{figure}{Representation of $S_n^c$}\label{fig: Sc breakdown}
\end{center}

where the red dot in the left most cells indicate any marking. For this paper, we will refer to a cell that can have any marking as an \textit{open}. We can conclude that $|S_n^c| = 6^{2}t_{n-1,2}$. Combining $S_n$ and $S_n^c$ gives the recurrence relation. Standard techniques then give the generating function and formula.
\end{proof}

\begin{theorem}\label{thm: m=3 case}
Setting $m=3$ gives
\begin{equation}
    T_3(x) = \sum_{n \geq 2}t_{n,3}x^n = \frac{(73-414x)x^2}{(1-216x)(1-228x+2699x^2-7758x^3)}
\end{equation}
\end{theorem}

\begin{proof}
For $t_{n,3}$ we directly compute the generating function $T_3(x)=\sum_{n \geq 2}t_{n,3}x^n$ using the following recurrence relation
$$t_{3,n} = 6^3 t_{n-1,3} + \sum_{i = 2}^{n}(6^{3(n-i)} - t_{n-i,3})f_{i},$$
where $f_{i}$ is the number of mosaics in an $i \times 3$ grid  that contain just one SAP that has cells in the left-most column. We similarly split $t_{n,3}$ into $S_n$ and $S_n^c$. Here let $S_n$ be the set that contains the mosaics that have just $1$ SAP that has cells in the left-most column. Therefore $S_n^c$ contains all mosaics that contain multiple SAPs and mosaics that contain $1$ SAP that does not have cells in the left-most column. 

Similarly for the $n=2$ case, $S_n^c$ can be easily enumerated. 
\begin{center}
    \begin{tikzpicture}
    \draw[thick] ( 0 , 0 ) rectangle ( 8 , 3 );
    % row1
    \cellopen{0}{0}{1}{1}
    % row2
    \cellopen{0}{1}{1}{2}
    % row3
    \cellopen{0}{2}{1}{3}
    % text
    \node[shape=circle,draw=white,fill=white, inner sep=0pt,minimum size=0pt] (A) at ( 4 , 1.5 ){$t_{n-1,3}$};
    \end{tikzpicture}
    \captionof{figure}{Representation of $S_n^c$}\label{fig: Sc breakdown for 3}
\end{center}

It is clear to see that $|S_n^c| = 6^3 t_{n-1,3},$ and so 
$$\sum_{n \geq 2} |S_n^c|x^n = 6^3 xT(x).$$

To enumerate $S_n$, as in the $n=2$ case, the SAP starts in the first column and ends at column $i$, after which there are no SAPs. This allows us to conclude that $|S_n| = \sum_{i = 2}^{n}(6^{3(n-i)} - t_{n-i,3})f_{i},$, where $f_i$ is the number of ways the cells to the left of and including column $i$ can contain $1$ SAP that includes the left-most column. To find the identity of $f_i$, we study the $4$ cases below.

\begin{center}
    \begin{tikzpicture}
        \draw[thick] ( 0 , 0 ) rectangle ( 7 , 3 );
        % row1
        \cellopen{0}{0}{1}{1}
        % row2
        \cellD{0}{1}{1}{2}
        % row3
        \cellA{0}{2}{1}{3}

        % row1
        \cellopen{4}{0}{5}{1}
        % row2
        \cellC{4}{1}{5}{2}
        % row3
        \cellB{4}{2}{5}{3}

        % text
        \node[shape=circle,draw=white,fill=white, inner sep=0pt,minimum size=0pt] (A) at ( 2.5 , 1.5 ){$a_{i}$};
    \end{tikzpicture}
    \begin{tikzpicture}
        \draw[thick] ( 0 , 0 ) rectangle ( 7 , 3 );
        % row1
        \cellopen{0}{0}{1}{1}
        % row2
        \cellD{0}{1}{1}{2}
        % row3
        \cellA{0}{2}{1}{3}

        % row1
        \cellC{4}{0}{5}{1}
        % row2
        \cellE{4}{1}{5}{2}
        % row3
        \cellB{4}{2}{5}{3}

        % text
        \node[shape=circle,draw=white,fill=white, inner sep=0pt,minimum size=0pt] (A) at ( 2.5 , 1.5 ){$b_{i}$};
    \end{tikzpicture}
\end{center}
\begin{center}
    \begin{tikzpicture}
        \draw[thick] ( 0 , 0 ) rectangle ( 7 , 3 );
        % row1
        \cellopen{0}{0}{1}{1}
        % row2
        \cellD{0}{1}{1}{2}
        % row3
        \cellA{0}{2}{1}{3}

        % row1
        \cellC{4}{0}{5}{1}
        % row2
        \cellB{4}{1}{5}{2}
        % row3
        \cellopen{4}{2}{5}{3}

        % text
        \node[shape=circle,draw=white,fill=white, inner sep=0pt,minimum size=0pt] (A) at ( 2.5 , 1.5 ){$c_{i}$};
    \end{tikzpicture}
    \begin{tikzpicture}
        \draw[thick] ( 0 , 0 ) rectangle ( 7 , 3 );
        % row1
        \cellD{0}{0}{1}{1}
        % row2
        \cellE{0}{1}{1}{2}
        % row3
        \cellA{0}{2}{1}{3}

        % row1
        \cellC{4}{0}{5}{1}
        % row2
        \cellE{4}{1}{5}{2}
        % row3
        \cellB{4}{2}{5}{3}

        % text
        \node[shape=circle,draw=white,fill=white, inner sep=0pt,minimum size=0pt] (A) at ( 2.5 , 1.5 ){$d_{i}$};
    \end{tikzpicture}
\end{center}

It is easy to see that $a_2 = 36$ and $a_3 = 216$. As $i$ increases, one can see that the enumeration of $a_i$ is related to smaller values of $a_i$ and $b_i$, more specifically
$$a_i = 6a_{i-1} + 6^2 b_{i-2}.$$

We find similar relations with the other $3$ cases, namely
$$b_n = 6b_{n-1} + 6^2 d_{n-2}$$
where $b_2 = 0$ and $b_3 = 6$
$$c_n = 6c_{n-1} + 6^2 b_{n-2}$$
where $c_2 = 0$ and $c_3 = 0$
$$d_n = 6d_{n-1} + 6^2 b_{n-2}$$
where $d_2 = 1$ and $d_3 = 6.$

Combining these $4$ cases, and accounting for the appropriate symmetries, we arrive at

$$f_i = 2a_i + 4b_i + 2c_i + d_i.$$

Solving this series of recurrence relations using generating functions gives

$$F(x) = \sum_{i \geq 2} f_i x^i = \frac{73 - 414x}{1-12x+43x^2}$$

This allows us to write 
$$\sum_{n \geq 2} |S_n|x^n = \left(\frac{1}{1-6^3x}-T(x)\right)F(x).$$

Combining these two generating functions and simplifying gives the result.

\end{proof}

\section{Full Solution}

TODO writeup, credit Farstar31!

$$
M(2) = \begin{bmatrix}
36 & 1 \\
-1 & 1
\end{bmatrix}
$$

For $h \geq 2$, then if
$$
M(h) = \begin{bmatrix}
M_1 & M_2 \\
M_3 & M_4
\end{bmatrix}
$$

then
$$
M(h+1) = \begin{bmatrix}
6M_1 & 6M_2 & \frac{1}{6}M_1 & 1M_2 \\
6M_3 & 6M_4 & 0M_3 & 1M_4 \\
-\frac{1}{6}M_1 & 0M_2 & \frac{1}{6}M_1 & 1M_2 \\
1M_3 & 1M_4 & -1M_3 & 6M_4 \\
\end{bmatrix}
$$

where $M_i$ is a sub-matrix (or possible a scalar) of the block matrix $M$.

\end{document}